(this["webpackJsonpcompletium-dapp-ideabox"]=this["webpackJsonpcompletium-dapp-ideabox"]||[]).push([[0],{168:function(e,t,a){e.exports=a(283)},174:function(e,t,a){},180:function(e,t){},182:function(e,t){},250:function(e,t){},252:function(e,t){},265:function(e,t){},267:function(e,t){},283:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(13),c=a.n(o),l=(a(77),a(33)),i=a.n(l),s=a(55),u=a(14),m=(a(174),a(23)),d=a(63);var p=Object(d.a)((function(){var e=Object(n.useState)({network:"edo2net",endpoint:"https://edonet.smartpy.io",contract:"KT1QNURPMuFJSmTLRttRutb4gfJ6NS4BfsM6",show:!1}),t=Object(u.a)(e,2),a=t[0],r=t[1];return{settings:a,setNetwork:function(e){r((function(t){return Object(m.a)(Object(m.a)({},t),{},{network:e})}))},setEndpoint:function(e){r((function(t){return Object(m.a)(Object(m.a)({},t),{},{endpoint:e})}))},setContract:function(e){r((function(t){return Object(m.a)(Object(m.a)({},t),{},{contract:e})}))},hideSettings:function(){r((function(e){return Object(m.a)(Object(m.a)({},e),{},{show:!1})}))},showSettings:function(){r((function(e){return Object(m.a)(Object(m.a)({},e),{},{show:!0})}))},getBcdUrl:function(){return"https://better-call.dev/"+a.network+"/"+a.contract}}})),f=Object(u.a)(p,2),E=f[0],h=f[1],g=a(336),b=a(337),y=a(93),v=a(335),w=a(284),x=a(92),k=Object(d.a)((function(e){var t=e.appName,a=r.a.useState((function(){return{wallet:null,tezos:null,accountPkh:null}})),n=Object(u.a)(a,2),o=n[0],c=o.wallet,l=o.tezos,m=o.accountPkh,d=n[1],p=Boolean(l);r.a.useEffect((function(){return x.a.onAvailabilityChange((function(e){d({wallet:e?new x.a(t):null,tezos:null,accountPkh:null})}))}),[d,t]);var f=r.a.useCallback(function(){var e=Object(s.a)(i.a.mark((function e(t,a){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,c){e.next=3;break}throw new Error("Thanos Wallet not available");case 3:return e.next=5,c.connect(t,a);case 5:return n=c.toTezos(),e.next=8,n.wallet.pkh();case 8:r=e.sent,d({wallet:c,tezos:n,accountPkh:r}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),alert("Failed to connect ThanosWallet: ".concat(e.t0.message));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,a){return e.apply(this,arguments)}}(),[d,c]);return{wallet:c,tezos:l,accountPkh:m,ready:p,connect:f}}),(function(e){return e.wallet}),(function(e){return e.tezos}),(function(e){return e.accountPkh}),(function(e){return e.ready}),(function(e){return e.connect})),S=Object(u.a)(k,6),j=S[0],C=S[1],O=S[2],I=S[3],T=S[4],z=S[5];var P=a(328),W=function(e){var t=T(),a=C();return t?r.a.createElement("div",null):a?r.a.createElement(w.a,{color:"secondary",disableElevation:!0,size:"small",style:{color:"white",position:"absolute",right:"160px"},onClick:e.handleConnect},"connect to wallet"):r.a.createElement(P.a,{href:"https://templewallet.com/",rel:"noopener",underline:"none",style:{position:"absolute",right:"160px"}},r.a.createElement(w.a,{variant:"contained",size:"small",disableElevation:!0,style:{backgroundColor:"#ed8936",color:"white",fontWeight:"bold"}},"Install Temple"))},N=a(140),B=a.n(N),A=a(139),R=a.n(A),F=a(350),U=a(329),L=a(353),M=a(334),J=a(330),_=a(331),H=a(332);var D=function(e){var t=h(),a=t.settings,n=t.setContract,o=t.setNetwork,c=t.setEndpoint,l=t.hideSettings,i=r.a.useState(a.contract),s=Object(u.a)(i,2),m=s[0],d=s[1],p=r.a.useState(a.network),f=Object(u.a)(p,2),E=f[0],g=f[1],b=r.a.useState(a.endpoint),y=Object(u.a)(b,2),v=y[0],x=y[1],k=function(){return m.length>0&(36!==(e=m).length|!e.startsWith("KT1"));var e};return r.a.createElement(L.a,{onClose:l,"aria-labelledby":"simple-dialog-title",open:a.show},r.a.createElement(U.a,{id:"simple-dialog-title"},"Settings"),r.a.createElement(J.a,null,r.a.createElement(_.a,null,"Fill the form below to point the DApp interface to another Smart Contract, network or endpoint."),r.a.createElement(H.a,{container:!0,spacing:3,style:{maringBottom:"12px"}},r.a.createElement(H.a,{item:!0,xs:12},r.a.createElement(F.a,{value:m,onChange:function(e){return d(e.target.value)},id:"contract",label:"Smart Contract Address",color:"secondary",fullWidth:!0,error:k(),helperText:k()?"Invalid address format":""})),r.a.createElement(H.a,{item:!0,xs:12},r.a.createElement(F.a,{value:E,onChange:function(e){return g(e.target.value)},id:"network",label:"Network",color:"secondary",fullWidth:!0})),r.a.createElement(H.a,{item:!0,xs:12},r.a.createElement(F.a,{value:v,onChange:function(e){return x(e.target.value)},id:"endpoint",label:"Endpoint",color:"secondary",fullWidth:!0})))),r.a.createElement(M.a,null,r.a.createElement(w.a,{onClick:l,color:"secondary"},"Cancel"),r.a.createElement(w.a,{onClick:function(){n(m),o(E),c(v),e.reloadStorage(),l()},color:"secondary"},"Save")))},G=function(e){var t=h(),a=(t.settings,t.showSettings);return r.a.createElement(w.a,{onClick:a,style:{color:"white"},component:"span"},r.a.createElement(R.a,null))},K=function(e){var t=Object(v.a)("(min-width:600px)")?"visible":"hidden",a="dark"===e.theme.palette.type;return r.a.createElement(g.a,{position:"static",color:a?"default":"secondary",style:{boxShadow:"none",opacity:1}},r.a.createElement(b.a,null,r.a.createElement(y.a,{variant:"h6",style:{fontFamily:"Alegreya Sans SC, sans-serif"}},"Completium"),r.a.createElement(y.a,{variant:"h6",style:{flexGrow:1,visibility:t}},e.appTitle),r.a.createElement(W,{handleConnect:e.handleConnect}),r.a.createElement(G,null),r.a.createElement("a",{href:"https://completium.com/docs/dapp-ideabox",target:"_blank"},r.a.createElement(w.a,{style:{color:"white"},component:"span"},r.a.createElement(B.a,null)))))},Q=a(148),V=a(348),Y=a(349),$=a(346),q=function(e){return r.a.createElement(g.a,{position:"static",color:"default",style:{boxShadow:"none",opacity:1,heigh:300}},r.a.createElement(b.a,{style:{minHeight:256}},r.a.createElement(y.a,{variant:"body2",color:"textSecondary",style:{flexGrow:1}},"@copyright ",e.appName," 2021")))},X=a(356),Z=a(351);function ee(e){return r.a.createElement(Z.a,Object.assign({elevation:6,variant:"filled"},e))}var te=function(e){return r.a.createElement(X.a,{open:e.open},r.a.createElement(ee,{severity:"info",style:{backgroundColor:e.theme.palette.secondary.main}},"Waiting for operation confirmation ..."))},ae=a(340),ne=a(341),re=a(338),oe=a(342),ce=a(91),le=a.n(ce),ie=a(141),se=a.n(ie),ue=function(e){var t=O(),a=T(),n=h().settings;return r.a.createElement(ae.a,null,r.a.createElement(ne.a,null,r.a.createElement(H.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center"},r.a.createElement(H.a,{item:!0,xs:1},e.boxopen&&a?r.a.createElement(re.a,{color:"secondary","aria-label":"upload picture",component:"span",onClick:function(){t.wallet.at(n.contract).then((function(t){t.methods.vote(e.id,1).send().then((function(t){console.log("waiting for ".concat(t.opHash," to be confirmed")),e.openSnack(),t.receipt().then((function(){e.handleReceipt()}))}))}))}},r.a.createElement(le.a,null)):e.boxopen?r.a.createElement("div",null):e.winner?r.a.createElement(se.a,{color:"secondary"}):r.a.createElement("div",null)),r.a.createElement(H.a,{item:!0,xs:11},r.a.createElement(H.a,{container:!0,direction:"column",justify:"center",alignItems:"flex-start",spacing:1},r.a.createElement(H.a,{item:!0},r.a.createElement(y.a,{color:e.boxopen||e.winner?"textPrimary":"textSecondary",variant:"h6",align:"left",style:{paddingLeft:12}}," ",e.title," ")),r.a.createElement(H.a,{item:!0},r.a.createElement(y.a,{color:e.boxopen||e.winner?"textPrimary":"textSecondary",variant:"body2",align:"left",style:{paddingLeft:12,paddingRight:12}}," ",e.desc," ")))))),r.a.createElement(oe.a,null),r.a.createElement(ne.a,{style:{paddingBottom:16}},r.a.createElement(H.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",style:{paddingLeft:26,paddingRight:12}},r.a.createElement(H.a,{item:!0,xs:9},r.a.createElement(H.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",spacing:3},r.a.createElement(H.a,{item:!0},r.a.createElement(y.a,{color:"textSecondary",style:{fontWeight:"bold"}}," #",e.id," ")),r.a.createElement(H.a,{item:!0},r.a.createElement(H.a,{container:!0,direciton:"row",justify:"flex-start",alignItems:"center",style:{paddingLeft:18}},r.a.createElement(y.a,{color:"textSecondary"},"by: "),r.a.createElement(y.a,{color:"textSecondary",style:{fontSize:14,fontFamily:"Courier Prime, monospace",padding:8,paddingTop:12}},e.author))),r.a.createElement(H.a,{item:!0},r.a.createElement(H.a,{container:!0,direciton:"row",justify:"flex-start",alignItems:"center"},r.a.createElement(y.a,{color:"textSecondary"},"creation: "),r.a.createElement(y.a,{color:"textSecondary",style:{fontSize:14,fontFamily:"Courier Prime, monospace",padding:8,paddingTop:12}},e.creation))))),r.a.createElement(H.a,{item:!0,xs:3},r.a.createElement(H.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center",spacing:1},r.a.createElement(H.a,{item:!0},r.a.createElement(y.a,null," ",e.nbvotes," ")),r.a.createElement(H.a,{item:!0},r.a.createElement(le.a,{fontSize:"small"})))))))},me=a(142),de=a.n(me),pe=a(343),fe=function(e){return r.a.createElement(X.a,{open:!0},r.a.createElement(pe.a,{color:"secondary",onClick:e.onClick},r.a.createElement(de.a,null)))},Ee=a(4),he=a(143),ge=a.n(he),be=a(51),ye=function(e){return e.reduce((function(e,t){return e+t.toString(16).padStart(2,"0")}),"")},ve=Object(Ee.a)((function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}))((function(e){var t=e.children,a=e.classes,n=e.onClose;return r.a.createElement(U.a,{disableTypography:!0,className:a.root},r.a.createElement(y.a,{variant:"h6"},t),r.a.createElement(re.a,{"aria-label":"close",className:a.closeButton,onClick:n},r.a.createElement(ge.a,null)))})),we=Object(Ee.a)((function(e){return{root:{padding:e.spacing(2)}}}))(J.a),xe=function(e){var t=O(),a=r.a.useState({title:"",desc:""}),n=Object(u.a)(a,2),o=n[0],c=n[1],l=h().settings,i=function(e){"standard-basic"===e.target.id?c({title:e.target.value,desc:o.desc}):c({title:o.title,desc:e.target.value})};return r.a.createElement(L.a,{open:e.open,onClose:e.onclose,fullWidth:!0},r.a.createElement(ve,{id:"customized-dialog-title",onClose:e.onclose},"New idea"),r.a.createElement(we,{dividers:!0,style:{padding:0}},r.a.createElement(H.a,{container:!0,direction:"column"},r.a.createElement(H.a,{item:!0},r.a.createElement(H.a,{container:!0,direction:"row",style:{padding:16},spacing:3},r.a.createElement(H.a,{item:!0},r.a.createElement(y.a,null,"Author:")),r.a.createElement(H.a,null,r.a.createElement(y.a,{color:"textSecondary",style:{fontSize:14,fontFamily:"Courier Prime, monospace",paddingTop:15}},e.account)))),r.a.createElement(oe.a,null),r.a.createElement(H.a,{item:!0,style:{padding:16,paddingBottom:0}},r.a.createElement(F.a,{id:"standard-basic",label:"Enter idea title",fullWidth:!0,color:"secondary",onChange:i})),r.a.createElement(H.a,{item:!0,style:{padding:16,paddingBottom:0}},r.a.createElement(F.a,{id:"standard-textarea",label:"Enter idea description",placeholder:"Placeholder",multiline:!0,color:"secondary",fullWidth:!0,rowsMax:5,onChange:i})),r.a.createElement(H.a,{item:!0},r.a.createElement(H.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center",style:{padding:16}},r.a.createElement(w.a,{onClick:function(){console.info(o),t.wallet.at(l.contract).then((function(t){var a=ye(Object(be.compressToUint8Array)(o.title)),n=ye(Object(be.compressToUint8Array)(o.desc));t.methods.add_idea(a,n).send().then((function(t){console.log("waiting for ".concat(t.opHash," to be confirmed")),e.openSnack(),t.receipt().then((function(){e.handleReceipt()})).catch((function(e){return console.log("Error: ".concat(e))}))})).catch((function(e){return console.log("Error: ".concat(e))}))})),e.onclose()}},"submit"))))))},ke=a(344),Se=a(144),je=a.n(Se),Ce=a(339),Oe=a(333),Ie=a(150),Te=a(345),ze=a(357),Pe=a(355),We=["sort by creation","sort by votes","sort by author","sort by id"];function Ne(e){var t=r.a.useState(!1),a=Object(u.a)(t,2),n=a[0],o=a[1],c=r.a.useRef(null),l=r.a.useState(1),i=Object(u.a)(l,2),s=i[0],m=i[1],d=function(e){c.current&&c.current.contains(e.target)||o(!1)};return r.a.createElement(H.a,{container:!0,direction:"column",alignItems:"center"},r.a.createElement(H.a,{item:!0,xs:12},r.a.createElement(ke.a,{variant:"outlined",color:"secondary",ref:c,"aria-label":"split button",disableElevation:!0},r.a.createElement(w.a,{onClick:function(){e.onClick(We[s]),console.info("You clicked ".concat(We[s]))},disableElevation:!0},We[s]),r.a.createElement(w.a,{color:"secondary",size:"small","aria-controls":n?"split-button-menu":void 0,"aria-expanded":n?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",onClick:function(){o((function(e){return!e}))},disableElevation:!0},r.a.createElement(je.a,null))),r.a.createElement(Te.a,{open:n,anchorEl:c.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:100}},(function(e){var t=e.TransitionProps,a=e.placement;return r.a.createElement(Oe.a,Object.assign({},t,{style:{transformOrigin:"bottom"===a?"center top":"center bottom"}}),r.a.createElement(Ie.a,null,r.a.createElement(Ce.a,{onClickAway:d},r.a.createElement(Pe.a,{id:"split-button-menu"},We.map((function(e,t){return r.a.createElement(ze.a,{key:e,disabled:2===t,selected:t===s,onClick:function(e){return function(e,t){m(t),o(!1)}(0,t)}},e)}))))))}))))}var Be=a(354),Ae=a(146),Re=a.n(Ae),Fe=a(147),Ue=a.n(Fe),Le=a(347),Me=function(e){return r.a.createElement($.a,{style:{height:"300px"}},r.a.createElement($.a,{style:{height:"40px"}}),r.a.createElement(Ie.a,{style:{opacity:.8,paddingLeft:18,paddingRight:18}},"loading"===e.accountState?r.a.createElement(H.a,{container:!0,direction:"row",alignItems:"center",spacing:2,style:{height:64}},r.a.createElement(H.a,{item:!0,xs:12},r.a.createElement(Le.a,{color:"secondary"}))):r.a.createElement(H.a,{container:!0,direction:"row",alignItems:"center",spacing:2},r.a.createElement(H.a,{item:!0,xs:2,direction:"row"},r.a.createElement(y.a,{color:"textSecondary"},"account :")),r.a.createElement(H.a,null,r.a.createElement(y.a,{style:{fontFamily:"Courier Prime, monospace"}},e.account)),e.isvoter?r.a.createElement(H.a,{item:!0,xs:3},r.a.createElement(H.a,{container:!0,direction:"row",justify:"flex-end",spacing:2},r.a.createElement(H.a,{item:!0},r.a.createElement(y.a,{color:"textSecondary"},"Number of votes left:")),r.a.createElement(H.a,{item:!0},r.a.createElement(y.a,null,e.nbvotes)))):r.a.createElement(H.a,{item:!0,xs:3},r.a.createElement(y.a,{color:"error"},"Not registered!")))))},Je=a(35);function _e(e,t){return e.sort((function(e,a){return"sort by votes"===t?a.nbvotes-e.nbvotes:"sort by creation"===t?a.creation-e.creation:"sort by author"===t?a.author-e.author:"sort by id"!==t||e.id-a.id}))}var He=function(e){return new Uint8Array(e.match(/.{1,2}/g).map((function(e){return parseInt(e,16)})))};function De(){var e=T(),t=z(),a=I(),n=h(),o=n.settings,c=n.getBcdUrl,l=r.a.useState(null),m=Object(u.a)(l,2),d=(m[0],m[1],r.a.useState({status:!1,ideas:[],votes:[]})),p=Object(u.a)(d,2),f=p[0],E=p[1],g=r.a.useState(!0),b=Object(u.a)(g,2),y=b[0],v=b[1],w=r.a.useCallback(Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(o.network);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),alert(e.t0.message);case 8:case 9:case"end":return e.stop()}}),e,null,[[0,5]])}))),[t]),x=r.a.useState(!1),k=Object(u.a)(x,2),S=k[0],j=k[1],C=r.a.useState(!1),O=Object(u.a)(C,2),W=O[0],N=O[1],B=r.a.useState(""),A=Object(u.a)(B,2),R=(A[0],A[1]);function F(){return U.apply(this,arguments)}function U(){return(U=Object(s.a)(i.a.mark((function e(){var t,a,n,r,c,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=new Je.b(o.endpoint),e.next=4,t.contract.at(o.contract);case 4:return a=e.sent,e.next=7,a.storage();case 7:n=e.sent,r=[],n.selected.forEach((function(e){return r.push(parseInt(0+e))})),c=[],n.idea.forEach((function(e,t,a){c.push({id:t,title:Object(be.decompressFromUint8Array)(He(e.title)),desc:Object(be.decompressFromUint8Array)(He(e.desc)),author:e.author,nbvotes:parseInt(0+e.nbvotes,10),creation:(e.creation+"").substring(0,10),winner:r.includes(parseInt(t))})})),l=[],n.voter.forEach((function(e,t,a){l[t]=parseInt(0+e,10)})),c=_e(c,"sort by creation"),console.log(c),E({status:0+n._state==="00",ideas:c,votes:l}),v(!1),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(0),v(!1),console.log("Error: ".concat(e.t0));case 24:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}function L(){return void 0!==f.votes&&a in f.votes}y&&F().then(console.log("content loaded"));var M=r.a.useMemo((function(){return Object(Q.a)({palette:{type:"light",secondary:{light:"#64b5f6",main:"#2196f3",dark:"#1976d2",contrastText:"#fff"}}})}),[!1]),J=function(){j(!1),F().then(console.log("content loaded"))},_=function(){j(!0)};return r.a.createElement("div",{className:"App"},r.a.createElement(V.a,{theme:M},r.a.createElement(Y.a,null),r.a.createElement(K,{theme:M,appTitle:"Vote for the best ideas!",handleConnect:w}),r.a.createElement($.a,{maxWidth:"md",style:{height:120}},e?r.a.createElement(Me,{account:a,isvoter:L(),nbvotes:f.votes[a]}):r.a.createElement("div",{style:{height:500}})),r.a.createElement($.a,{maxWidth:"md"},r.a.createElement(H.a,{container:!0,direction:"row",spacing:2,style:{marginBottom:100}},r.a.createElement(H.a,{item:!0,xs:12},r.a.createElement(P.a,{href:c()+"/operations",rel:"noopener",underline:"none",target:"_blank"},r.a.createElement(Be.a,{label:"Box "+o.contract+(f.status?" is active":" is closed"),color:f.status?"secondary":"default",clickable:!0,onDelete:function(){},deleteIcon:f.status?r.a.createElement(Re.a,null):r.a.createElement(Ue.a,null),variant:"outlined"}))),y?r.a.createElement(H.a,{item:!0,xs:12},r.a.createElement(Le.a,{color:"secondary",style:{marginTop:60}})):r.a.createElement(H.a,{item:!0},r.a.createElement(Ne,{onClick:function(e){R(e),E({status:f.status,ideas:_e(f.ideas,e),votes:f.votes})}})),f.ideas.map((function(t){return r.a.createElement(H.a,{item:!0,xs:12},r.a.createElement(ue,{id:t.id,title:t.title,desc:t.desc,author:t.author,creation:t.creation,nbvotes:t.nbvotes,winner:t.winner,boxopen:f.status&&e&&L(),openSnack:_,handleReceipt:J}))})))),f.status&&e&&L()&&!S?r.a.createElement(fe,{onClick:function(){N(!0)}}):r.a.createElement("div",null),r.a.createElement(q,{appName:"IdeaCorp."}),r.a.createElement(xe,{open:W,onclose:function(){N(!1)},theme:M,account:a,openSnack:_,handleReceipt:J}),r.a.createElement(D,{reloadStorage:function(){v(!0)}}),r.a.createElement(te,{open:S,theme:M})))}var Ge=function(){return r.a.createElement(j,{appName:"IdeaCorp."},r.a.createElement(E,null,r.a.createElement(r.a.Suspense,{fallback:null},r.a.createElement(De,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ge,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},77:function(e,t,a){}},[[168,1,2]]]);
//# sourceMappingURL=main.086545ed.chunk.js.map