(this["webpackJsonpcompletium-dapp-ideabox"]=this["webpackJsonpcompletium-dapp-ideabox"]||[]).push([[0],{150:function(e,t){},236:function(e,t,a){e.exports=a(427)},242:function(e,t,a){},248:function(e,t){},250:function(e,t){},315:function(e,t){},317:function(e,t){},327:function(e,t){},329:function(e,t){},354:function(e,t){},356:function(e,t){},357:function(e,t){},363:function(e,t){},365:function(e,t){},383:function(e,t){},385:function(e,t){},397:function(e,t){},400:function(e,t){},427:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(15),c=a.n(r),l=(a(93),a(38)),i=a.n(l),s=a(69),u=a(20),m=(a(242),"KT1HNsJScj3HfK831xqViGxWsbDbczdKPax4"),d=a(472),p=a(475),f=a(221),E=a(471),h=a(429),g=a(476),y=a(206),b=a(124),v=Object(y.a)((function(e){var t=e.appName,a=o.a.useState((function(){return{wallet:null,tezos:null,accountPkh:null}})),n=Object(u.a)(a,2),r=n[0],c=r.wallet,l=r.tezos,m=r.accountPkh,d=n[1],p=Boolean(l);o.a.useEffect((function(){return b.a.onAvailabilityChange((function(e){d({wallet:e?new b.a(t):null,tezos:null,accountPkh:null})}))}),[d,t]);var f=o.a.useCallback(function(){var e=Object(s.a)(i.a.mark((function e(t,a){var n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,c){e.next=3;break}throw new Error("Thanos Wallet not available");case 3:return e.next=5,c.connect(t,a);case 5:return n=c.toTezos(),e.next=8,n.wallet.pkh();case 8:o=e.sent,d({wallet:c,tezos:n,accountPkh:o}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),alert("Failed to connect ThanosWallet: ".concat(e.t0.message));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,a){return e.apply(this,arguments)}}(),[d,c]);return{wallet:c,tezos:l,accountPkh:m,ready:p,connect:f}}),(function(e){return e.wallet}),(function(e){return e.tezos}),(function(e){return e.accountPkh}),(function(e){return e.ready}),(function(e){return e.connect})),x=Object(u.a)(v,6),w=x[0],k=x[1],S=x[2],j=x[3],C=x[4],O=x[5];var I=function(e){var t=C(),a=k(),n=Object(E.a)("(min-width:600px)")?"visible":"hidden",r="dark"===e.theme.palette.type;return o.a.createElement(d.a,{position:"static",color:r?"default":"secondary",style:{boxShadow:"none",opacity:1}},o.a.createElement(p.a,null,o.a.createElement(f.a,{variant:"h6",style:{position:"absolute",fontFamily:"Alegreya Sans SC, sans-serif"}},"Completium"),o.a.createElement(f.a,{variant:"h6",style:{flexGrow:1,visibility:n}},e.appTitle),t?o.a.createElement("div",null):a?o.a.createElement(h.a,{variant:"contained",color:"secondary",disableElevation:!0,size:"small",style:{position:"absolute",right:"1%"},onClick:e.handleConnect},"connect to wallet"):o.a.createElement(g.a,{href:"https://thanoswallet.com/",rel:"noopener",underline:"none",style:{position:"absolute",right:"1%"}},o.a.createElement(h.a,{variant:"contained",size:"small",disableElevation:!0,style:{backgroundColor:"#ed8936",color:"white",fontWeight:"bold"}},"Install Thanos"))))},z=a(218),P=a(491),T=a(492),W=a(489),N=a(482),A=function(e){return o.a.createElement(d.a,{position:"static",color:"default",style:{boxShadow:"none",opacity:1,heigh:300}},o.a.createElement(p.a,{style:{minHeight:256}},o.a.createElement(f.a,{variant:"body2",color:"textSecondary",style:{flexGrow:1}},"@copyright ",e.appName," 2021")))},B=a(498),F=a(494);function R(e){return o.a.createElement(F.a,Object.assign({elevation:6,variant:"filled"},e))}var H=function(e){return o.a.createElement(B.a,{open:e.open},o.a.createElement(R,{severity:"info",style:{backgroundColor:e.theme.palette.secondary.main}},"Waiting for operation confirmation ..."))},L=a(480),U=a(481),G=a(477),J=a(483),K=a(123),M=a.n(K),D=a(211),V=a.n(D),_=function(e){var t=S(),a=C();return o.a.createElement(L.a,null,o.a.createElement(U.a,null,o.a.createElement(N.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center"},o.a.createElement(N.a,{item:!0,xs:1},e.boxopen&&a?o.a.createElement(G.a,{color:"secondary","aria-label":"upload picture",component:"span",onClick:function(){t.wallet.at(m).then((function(t){t.methods.vote(e.id,1).send().then((function(t){console.log("waiting for ".concat(t.opHash," to be confirmed")),e.openSnack(),t.receipt().then((function(){e.handleReceipt()}))}))}))}},o.a.createElement(M.a,null)):e.boxopen?o.a.createElement("div",null):e.winner?o.a.createElement(V.a,{color:"secondary"}):o.a.createElement("div",null)),o.a.createElement(N.a,{item:!0,xs:11},o.a.createElement(N.a,{container:!0,direction:"column",justify:"center",alignItems:"flex-start",spacing:1},o.a.createElement(N.a,{item:!0},o.a.createElement(f.a,{color:e.boxopen||e.winner?"textPrimary":"textSecondary",variant:"h6",align:"left",style:{paddingLeft:12}}," ",e.title," ")),o.a.createElement(N.a,{item:!0},o.a.createElement(f.a,{color:e.boxopen||e.winner?"textPrimary":"textSecondary",variant:"body2",align:"left",style:{paddingLeft:12,paddingRight:12}}," ",e.desc," ")))))),o.a.createElement(J.a,null),o.a.createElement(U.a,{style:{paddingBottom:16}},o.a.createElement(N.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",style:{paddingLeft:26,paddingRight:12}},o.a.createElement(N.a,{item:!0,xs:9},o.a.createElement(N.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",spacing:3},o.a.createElement(N.a,{item:!0},o.a.createElement(f.a,{color:"textSecondary",style:{fontWeight:"bold"}}," #",e.id," ")),o.a.createElement(N.a,{item:!0},o.a.createElement(N.a,{container:!0,direciton:"row",justify:"flex-start",alignItems:"center",style:{paddingLeft:18}},o.a.createElement(f.a,{color:"textSecondary"},"by: "),o.a.createElement(f.a,{color:"textSecondary",style:{fontSize:14,fontFamily:"Courier Prime, monospace",padding:8,paddingTop:12}},e.author))),o.a.createElement(N.a,{item:!0},o.a.createElement(N.a,{container:!0,direciton:"row",justify:"flex-start",alignItems:"center"},o.a.createElement(f.a,{color:"textSecondary"},"creation: "),o.a.createElement(f.a,{color:"textSecondary",style:{fontSize:14,fontFamily:"Courier Prime, monospace",padding:8,paddingTop:12}},e.creation))))),o.a.createElement(N.a,{item:!0,xs:3},o.a.createElement(N.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center",spacing:1},o.a.createElement(N.a,{item:!0},o.a.createElement(f.a,null," ",e.nbvotes," ")),o.a.createElement(N.a,{item:!0},o.a.createElement(M.a,{fontSize:"small"})))))))},q=a(212),Y=a.n(q),$=a(484),Q=function(e){return o.a.createElement(B.a,{open:!0},o.a.createElement($.a,{color:"secondary",onClick:e.onClick},o.a.createElement(Y.a,null)))},X=a(496),Z=a(493),ee=a(4),te=a(485),ae=a(486),ne=a(213),oe=a.n(ne),re=a(57),ce=function(e){return e.reduce((function(e,t){return e+t.toString(16).padStart(2,"0")}),"")},le=Object(ee.a)((function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}))((function(e){var t=e.children,a=e.classes,n=e.onClose;return o.a.createElement(te.a,{disableTypography:!0,className:a.root},o.a.createElement(f.a,{variant:"h6"},t),o.a.createElement(G.a,{"aria-label":"close",className:a.closeButton,onClick:n},o.a.createElement(oe.a,null)))})),ie=Object(ee.a)((function(e){return{root:{padding:e.spacing(2)}}}))(ae.a),se=function(e){var t=S(),a=o.a.useState({title:"",desc:""}),n=Object(u.a)(a,2),r=n[0],c=n[1],l=function(e){"standard-basic"===e.target.id?c({title:e.target.value,desc:r.desc}):c({title:r.title,desc:e.target.value})};return o.a.createElement(X.a,{open:e.open,onClose:e.onclose,fullWidth:!0},o.a.createElement(le,{id:"customized-dialog-title",onClose:e.onclose},"New idea"),o.a.createElement(ie,{dividers:!0,style:{padding:0}},o.a.createElement(N.a,{container:!0,direction:"column"},o.a.createElement(N.a,{item:!0},o.a.createElement(N.a,{container:!0,direction:"row",style:{padding:16},spacing:3},o.a.createElement(N.a,{item:!0},o.a.createElement(f.a,null,"Author:")),o.a.createElement(N.a,null,o.a.createElement(f.a,{color:"textSecondary",style:{fontSize:14,fontFamily:"Courier Prime, monospace",paddingTop:15}},e.account)))),o.a.createElement(J.a,null),o.a.createElement(N.a,{item:!0,style:{padding:16,paddingBottom:0}},o.a.createElement(Z.a,{id:"standard-basic",label:"Enter idea title",fullWidth:!0,color:"secondary",onChange:l})),o.a.createElement(N.a,{item:!0,style:{padding:16,paddingBottom:0}},o.a.createElement(Z.a,{id:"standard-textarea",label:"Enter idea description",placeholder:"Placeholder",multiline:!0,color:"secondary",fullWidth:!0,rowsMax:5,onChange:l})),o.a.createElement(N.a,{item:!0},o.a.createElement(N.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center",style:{padding:16}},o.a.createElement(h.a,{onClick:function(){console.info(r),t.wallet.at(m).then((function(t){var a=ce(Object(re.compressToUint8Array)(r.title)),n=ce(Object(re.compressToUint8Array)(r.desc));t.methods.add_idea(a,n).send().then((function(t){console.log("waiting for ".concat(t.opHash," to be confirmed")),e.openSnack(),t.receipt().then((function(){e.handleReceipt()})).catch((function(e){return console.log("Error: ".concat(e))}))})).catch((function(e){return console.log("Error: ".concat(e))}))})),e.onclose()}},"submit"))))))},ue=a(487),me=a(214),de=a.n(me),pe=a(479),fe=a(478),Ee=a(219),he=a(488),ge=a(500),ye=a(499),be=["sort by creation","sort by votes","sort by author","sort by id"];function ve(e){var t=o.a.useState(!1),a=Object(u.a)(t,2),n=a[0],r=a[1],c=o.a.useRef(null),l=o.a.useState(1),i=Object(u.a)(l,2),s=i[0],m=i[1],d=function(e){c.current&&c.current.contains(e.target)||r(!1)};return o.a.createElement(N.a,{container:!0,direction:"column",alignItems:"center"},o.a.createElement(N.a,{item:!0,xs:12},o.a.createElement(ue.a,{variant:"outlined",color:"secondary",ref:c,"aria-label":"split button",disableElevation:!0},o.a.createElement(h.a,{onClick:function(){e.onClick(be[s]),console.info("You clicked ".concat(be[s]))},disableElevation:!0},be[s]),o.a.createElement(h.a,{color:"secondary",size:"small","aria-controls":n?"split-button-menu":void 0,"aria-expanded":n?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",onClick:function(){r((function(e){return!e}))},disableElevation:!0},o.a.createElement(de.a,null))),o.a.createElement(he.a,{open:n,anchorEl:c.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:100}},(function(e){var t=e.TransitionProps,a=e.placement;return o.a.createElement(fe.a,Object.assign({},t,{style:{transformOrigin:"bottom"===a?"center top":"center bottom"}}),o.a.createElement(Ee.a,null,o.a.createElement(pe.a,{onClickAway:d},o.a.createElement(ye.a,{id:"split-button-menu"},be.map((function(e,t){return o.a.createElement(ge.a,{key:e,disabled:2===t,selected:t===s,onClick:function(e){return function(e,t){m(t),r(!1)}(0,t)}},e)}))))))}))))}var xe=a(497),we=a(216),ke=a.n(we),Se=a(217),je=a.n(Se),Ce=a(490),Oe=function(e){return o.a.createElement(W.a,{style:{height:"300px"}},o.a.createElement(W.a,{style:{height:"40px"}}),o.a.createElement(Ee.a,{style:{opacity:.8,paddingLeft:18,paddingRight:18}},"loading"===e.accountState?o.a.createElement(N.a,{container:!0,direction:"row",alignItems:"center",spacing:2,style:{height:64}},o.a.createElement(N.a,{item:!0,xs:12},o.a.createElement(Ce.a,{color:"secondary"}))):o.a.createElement(N.a,{container:!0,direction:"row",alignItems:"center",spacing:2},o.a.createElement(N.a,{item:!0,xs:2,direction:"row"},o.a.createElement(f.a,{color:"textSecondary"},"account :")),o.a.createElement(N.a,null,o.a.createElement(f.a,{style:{fontFamily:"Courier Prime, monospace"}},e.account)),e.isvoter?o.a.createElement(N.a,{item:!0,xs:3},o.a.createElement(N.a,{container:!0,direction:"row",justify:"flex-end",spacing:2},o.a.createElement(N.a,{item:!0},o.a.createElement(f.a,{color:"textSecondary"},"Number of votes left:")),o.a.createElement(N.a,{item:!0},o.a.createElement(f.a,null,e.nbvotes)))):o.a.createElement(N.a,{item:!0,xs:3},o.a.createElement(f.a,{color:"error"},"Not registered!")))))},Ie=a(40);function ze(e,t){return e.sort((function(e,a){return"sort by votes"===t?a.nbvotes-e.nbvotes:"sort by creation"===t?a.creation-e.creation:"sort by author"===t?a.author-e.author:"sort by id"!==t||e.id-a.id}))}var Pe=function(e){return new Uint8Array(e.match(/.{1,2}/g).map((function(e){return parseInt(e,16)})))};function Te(){var e=C(),t=O(),a=j(),n=o.a.useState(null),r=Object(u.a)(n,2),c=(r[0],r[1],o.a.useState({status:!1,ideas:[],votes:[]})),l=Object(u.a)(c,2),d=l[0],p=l[1],f=o.a.useCallback(Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t("carthagenet");case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),alert(e.t0.message);case 8:case 9:case"end":return e.stop()}}),e,null,[[0,5]])}))),[t]),E=o.a.useState(!1),h=Object(u.a)(E,2),g=h[0],y=h[1],b=o.a.useState(!1),v=Object(u.a)(b,2),x=v[0],w=v[1],k=o.a.useState(""),S=Object(u.a)(k,2),B=(S[0],S[1]);function F(){return R.apply(this,arguments)}function R(){return(R=Object(s.a)(i.a.mark((function e(){var t,a,n,o,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Ie.a.setProvider({rpc:"https://testnet-tezos.giganode.io/"}),e.next=4,Ie.a.contract.at(m);case 4:return t=e.sent,e.next=7,t.storage();case 7:a=e.sent,n=[],a.selected.forEach((function(e){return n.push(parseInt(0+e))})),o=[],a.idea.forEach((function(e,t,a){o.push({id:t,title:Object(re.decompressFromUint8Array)(Pe(e.title)),desc:Object(re.decompressFromUint8Array)(Pe(e.desc)),author:e.author,nbvotes:parseInt(0+e.nbvotes,10),creation:(e.creation+"").substring(0,10),winner:n.includes(parseInt(t))})})),r=[],a.voter.forEach((function(e,t,a){r[t]=parseInt(0+e,10)})),o=ze(o,"sort by creation"),console.log(o),p({status:0+a._state==="00",ideas:o,votes:r}),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log("Error: ".concat(e.t0));case 22:case"end":return e.stop()}}),e,null,[[0,19]])})))).apply(this,arguments)}function L(){return void 0!==d.votes&&a in d.votes}0===d.ideas.length&&F().then(console.log("content loaded"));var U=o.a.useMemo((function(){return Object(z.a)({palette:{type:"light",secondary:{light:"#64b5f6",main:"#2196f3",dark:"#1976d2",contrastText:"#fff"}}})}),[!1]),G=function(){y(!1),F().then(console.log("content loaded"))},J=function(){y(!0)};return o.a.createElement("div",{className:"App"},o.a.createElement(P.a,{theme:U},o.a.createElement(T.a,null),o.a.createElement(I,{theme:U,appTitle:"Vote for the best ideas!",handleConnect:f}),o.a.createElement(W.a,{maxWidth:"md",style:{height:120}},e?o.a.createElement(Oe,{account:a,isvoter:L(),nbvotes:d.votes[a]}):o.a.createElement("div",{style:{height:500}})),o.a.createElement(W.a,{maxWidth:"md"},o.a.createElement(N.a,{container:!0,direction:"row",spacing:2,style:{marginBottom:100}},o.a.createElement(N.a,{item:!0,xs:12},o.a.createElement(xe.a,{label:"Box "+m+(d.status?" is active":" is closed"),color:d.status?"secondary":"default",clickable:!0,onDelete:function(){},deleteIcon:d.status?o.a.createElement(ke.a,null):o.a.createElement(je.a,null),variant:"outlined"})),0===d.ideas.length?o.a.createElement(N.a,{item:!0,xs:12},o.a.createElement(Ce.a,{color:"secondary",style:{marginTop:60}})):o.a.createElement(N.a,{item:!0},o.a.createElement(ve,{onClick:function(e){B(e),p({status:d.status,ideas:ze(d.ideas,e),votes:d.votes})}})),d.ideas.map((function(t){return o.a.createElement(N.a,{item:!0,xs:12},o.a.createElement(_,{id:t.id,title:t.title,desc:t.desc,author:t.author,creation:t.creation,nbvotes:t.nbvotes,winner:t.winner,boxopen:d.status&&e&&L(),openSnack:J,handleReceipt:G}))})))),d.status&&e&&L()&&!g?o.a.createElement(Q,{onClick:function(){w(!0)}}):o.a.createElement("div",null),o.a.createElement(A,{appName:"IdeaCorp."}),o.a.createElement(se,{open:x,onclose:function(){w(!1)},theme:U,account:a,openSnack:J,handleReceipt:G}),o.a.createElement(H,{open:g,theme:U})))}var We=function(){return o.a.createElement(w,{appName:"IdeaCorp."},o.a.createElement(o.a.Suspense,{fallback:null},o.a.createElement(Te,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(We,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},93:function(e,t,a){}},[[236,1,2]]]);
//# sourceMappingURL=main.1fc1c0ca.chunk.js.map