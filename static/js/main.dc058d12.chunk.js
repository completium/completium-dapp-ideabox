(this["webpackJsonpcompletium-dapp-ideabox"]=this["webpackJsonpcompletium-dapp-ideabox"]||[]).push([[0],{163:function(e,t,a){e.exports=a(278)},169:function(e,t,a){},175:function(e,t){},177:function(e,t){},245:function(e,t){},247:function(e,t){},260:function(e,t){},262:function(e,t){},278:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(13),c=a.n(o),l=(a(74),a(32)),i=a.n(l),s=a(54),u=a(20),m=(a(169),"KT1QMowNVCUngertU7bAeoZmU7XYm3gphE69"),d=a(325),p=a(326),f=a(146),E=a(324),h=a(279),g=a(131),y=a(89),b=Object(g.a)((function(e){var t=e.appName,a=r.a.useState((function(){return{wallet:null,tezos:null,accountPkh:null}})),n=Object(u.a)(a,2),o=n[0],c=o.wallet,l=o.tezos,m=o.accountPkh,d=n[1],p=Boolean(l);r.a.useEffect((function(){return y.a.onAvailabilityChange((function(e){d({wallet:e?new y.a(t):null,tezos:null,accountPkh:null})}))}),[d,t]);var f=r.a.useCallback(function(){var e=Object(s.a)(i.a.mark((function e(t,a){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,c){e.next=3;break}throw new Error("Thanos Wallet not available");case 3:return e.next=5,c.connect(t,a);case 5:return n=c.toTezos(),e.next=8,n.wallet.pkh();case 8:r=e.sent,d({wallet:c,tezos:n,accountPkh:r}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),alert("Failed to connect ThanosWallet: ".concat(e.t0.message));case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t,a){return e.apply(this,arguments)}}(),[d,c]);return{wallet:c,tezos:l,accountPkh:m,ready:p,connect:f}}),(function(e){return e.wallet}),(function(e){return e.tezos}),(function(e){return e.accountPkh}),(function(e){return e.ready}),(function(e){return e.connect})),v=Object(u.a)(b,6),x=v[0],w=v[1],k=v[2],S=v[3],C=v[4],j=v[5];var O=a(323),I=function(e){var t=C(),a=w();return t?r.a.createElement("div",null):a?r.a.createElement(h.a,{variant:"contained",color:"secondary",disableElevation:!0,size:"small",style:{position:"absolute",right:"90px"},onClick:e.handleConnect},"connect to wallet"):r.a.createElement(O.a,{href:"https://thanoswallet.com/",rel:"noopener",underline:"none",style:{position:"absolute",right:"1%"}},r.a.createElement(h.a,{variant:"contained",size:"small",disableElevation:!0,style:{backgroundColor:"#ed8936",color:"white",fontWeight:"bold"}},"Install Thanos"))},z=a(136),T=a.n(z),P=function(e){var t=Object(E.a)("(min-width:600px)")?"visible":"hidden",a="dark"===e.theme.palette.type;return r.a.createElement(d.a,{position:"static",color:a?"default":"secondary",style:{boxShadow:"none",opacity:1}},r.a.createElement(p.a,null,r.a.createElement(f.a,{variant:"h6",style:{position:"absolute",fontFamily:"Alegreya Sans SC, sans-serif"}},"Completium"),r.a.createElement(f.a,{variant:"h6",style:{flexGrow:1,visibility:t}},e.appTitle),r.a.createElement(I,{handleConnect:e.handleConnect}),r.a.createElement("a",{href:"https://edukera.github.io/completium-landing/docs/dapp-ideabox/presentation",target:"_blank"},r.a.createElement(h.a,{style:{color:"white"},component:"span"},r.a.createElement(T.a,null)))))},W=a(144),A=a(341),N=a(342),B=a(339),F=a(332),R=function(e){return r.a.createElement(d.a,{position:"static",color:"default",style:{boxShadow:"none",opacity:1,heigh:300}},r.a.createElement(p.a,{style:{minHeight:256}},r.a.createElement(f.a,{variant:"body2",color:"textSecondary",style:{flexGrow:1}},"@copyright ",e.appName," 2021")))},U=a(348),L=a(344);function M(e){return r.a.createElement(L.a,Object.assign({elevation:6,variant:"filled"},e))}var H=function(e){return r.a.createElement(U.a,{open:e.open},r.a.createElement(M,{severity:"info",style:{backgroundColor:e.theme.palette.secondary.main}},"Waiting for operation confirmation ..."))},_=a(330),G=a(331),J=a(327),V=a(333),Y=a(88),D=a.n(Y),K=a(137),Q=a.n(K),X=function(e){var t=k(),a=C();return r.a.createElement(_.a,null,r.a.createElement(G.a,null,r.a.createElement(F.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center"},r.a.createElement(F.a,{item:!0,xs:1},e.boxopen&&a?r.a.createElement(J.a,{color:"secondary","aria-label":"upload picture",component:"span",onClick:function(){t.wallet.at(m).then((function(t){t.methods.vote(e.id,1).send().then((function(t){console.log("waiting for ".concat(t.opHash," to be confirmed")),e.openSnack(),t.receipt().then((function(){e.handleReceipt()}))}))}))}},r.a.createElement(D.a,null)):e.boxopen?r.a.createElement("div",null):e.winner?r.a.createElement(Q.a,{color:"secondary"}):r.a.createElement("div",null)),r.a.createElement(F.a,{item:!0,xs:11},r.a.createElement(F.a,{container:!0,direction:"column",justify:"center",alignItems:"flex-start",spacing:1},r.a.createElement(F.a,{item:!0},r.a.createElement(f.a,{color:e.boxopen||e.winner?"textPrimary":"textSecondary",variant:"h6",align:"left",style:{paddingLeft:12}}," ",e.title," ")),r.a.createElement(F.a,{item:!0},r.a.createElement(f.a,{color:e.boxopen||e.winner?"textPrimary":"textSecondary",variant:"body2",align:"left",style:{paddingLeft:12,paddingRight:12}}," ",e.desc," ")))))),r.a.createElement(V.a,null),r.a.createElement(G.a,{style:{paddingBottom:16}},r.a.createElement(F.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",style:{paddingLeft:26,paddingRight:12}},r.a.createElement(F.a,{item:!0,xs:9},r.a.createElement(F.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"center",spacing:3},r.a.createElement(F.a,{item:!0},r.a.createElement(f.a,{color:"textSecondary",style:{fontWeight:"bold"}}," #",e.id," ")),r.a.createElement(F.a,{item:!0},r.a.createElement(F.a,{container:!0,direciton:"row",justify:"flex-start",alignItems:"center",style:{paddingLeft:18}},r.a.createElement(f.a,{color:"textSecondary"},"by: "),r.a.createElement(f.a,{color:"textSecondary",style:{fontSize:14,fontFamily:"Courier Prime, monospace",padding:8,paddingTop:12}},e.author))),r.a.createElement(F.a,{item:!0},r.a.createElement(F.a,{container:!0,direciton:"row",justify:"flex-start",alignItems:"center"},r.a.createElement(f.a,{color:"textSecondary"},"creation: "),r.a.createElement(f.a,{color:"textSecondary",style:{fontSize:14,fontFamily:"Courier Prime, monospace",padding:8,paddingTop:12}},e.creation))))),r.a.createElement(F.a,{item:!0,xs:3},r.a.createElement(F.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center",spacing:1},r.a.createElement(F.a,{item:!0},r.a.createElement(f.a,null," ",e.nbvotes," ")),r.a.createElement(F.a,{item:!0},r.a.createElement(D.a,{fontSize:"small"})))))))},Z=a(138),$=a.n(Z),q=a(334),ee=function(e){return r.a.createElement(U.a,{open:!0},r.a.createElement(q.a,{color:"secondary",onClick:e.onClick},r.a.createElement($.a,null)))},te=a(346),ae=a(343),ne=a(4),re=a(335),oe=a(336),ce=a(139),le=a.n(ce),ie=a(47),se=function(e){return e.reduce((function(e,t){return e+t.toString(16).padStart(2,"0")}),"")},ue=Object(ne.a)((function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}))((function(e){var t=e.children,a=e.classes,n=e.onClose;return r.a.createElement(re.a,{disableTypography:!0,className:a.root},r.a.createElement(f.a,{variant:"h6"},t),r.a.createElement(J.a,{"aria-label":"close",className:a.closeButton,onClick:n},r.a.createElement(le.a,null)))})),me=Object(ne.a)((function(e){return{root:{padding:e.spacing(2)}}}))(oe.a),de=function(e){var t=k(),a=r.a.useState({title:"",desc:""}),n=Object(u.a)(a,2),o=n[0],c=n[1],l=function(e){"standard-basic"===e.target.id?c({title:e.target.value,desc:o.desc}):c({title:o.title,desc:e.target.value})};return r.a.createElement(te.a,{open:e.open,onClose:e.onclose,fullWidth:!0},r.a.createElement(ue,{id:"customized-dialog-title",onClose:e.onclose},"New idea"),r.a.createElement(me,{dividers:!0,style:{padding:0}},r.a.createElement(F.a,{container:!0,direction:"column"},r.a.createElement(F.a,{item:!0},r.a.createElement(F.a,{container:!0,direction:"row",style:{padding:16},spacing:3},r.a.createElement(F.a,{item:!0},r.a.createElement(f.a,null,"Author:")),r.a.createElement(F.a,null,r.a.createElement(f.a,{color:"textSecondary",style:{fontSize:14,fontFamily:"Courier Prime, monospace",paddingTop:15}},e.account)))),r.a.createElement(V.a,null),r.a.createElement(F.a,{item:!0,style:{padding:16,paddingBottom:0}},r.a.createElement(ae.a,{id:"standard-basic",label:"Enter idea title",fullWidth:!0,color:"secondary",onChange:l})),r.a.createElement(F.a,{item:!0,style:{padding:16,paddingBottom:0}},r.a.createElement(ae.a,{id:"standard-textarea",label:"Enter idea description",placeholder:"Placeholder",multiline:!0,color:"secondary",fullWidth:!0,rowsMax:5,onChange:l})),r.a.createElement(F.a,{item:!0},r.a.createElement(F.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center",style:{padding:16}},r.a.createElement(h.a,{onClick:function(){console.info(o),t.wallet.at(m).then((function(t){var a=se(Object(ie.compressToUint8Array)(o.title)),n=se(Object(ie.compressToUint8Array)(o.desc));t.methods.add_idea(a,n).send().then((function(t){console.log("waiting for ".concat(t.opHash," to be confirmed")),e.openSnack(),t.receipt().then((function(){e.handleReceipt()})).catch((function(e){return console.log("Error: ".concat(e))}))})).catch((function(e){return console.log("Error: ".concat(e))}))})),e.onclose()}},"submit"))))))},pe=a(337),fe=a(140),Ee=a.n(fe),he=a(329),ge=a(328),ye=a(147),be=a(338),ve=a(350),xe=a(349),we=["sort by creation","sort by votes","sort by author","sort by id"];function ke(e){var t=r.a.useState(!1),a=Object(u.a)(t,2),n=a[0],o=a[1],c=r.a.useRef(null),l=r.a.useState(1),i=Object(u.a)(l,2),s=i[0],m=i[1],d=function(e){c.current&&c.current.contains(e.target)||o(!1)};return r.a.createElement(F.a,{container:!0,direction:"column",alignItems:"center"},r.a.createElement(F.a,{item:!0,xs:12},r.a.createElement(pe.a,{variant:"outlined",color:"secondary",ref:c,"aria-label":"split button",disableElevation:!0},r.a.createElement(h.a,{onClick:function(){e.onClick(we[s]),console.info("You clicked ".concat(we[s]))},disableElevation:!0},we[s]),r.a.createElement(h.a,{color:"secondary",size:"small","aria-controls":n?"split-button-menu":void 0,"aria-expanded":n?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",onClick:function(){o((function(e){return!e}))},disableElevation:!0},r.a.createElement(Ee.a,null))),r.a.createElement(be.a,{open:n,anchorEl:c.current,role:void 0,transition:!0,disablePortal:!0,style:{zIndex:100}},(function(e){var t=e.TransitionProps,a=e.placement;return r.a.createElement(ge.a,Object.assign({},t,{style:{transformOrigin:"bottom"===a?"center top":"center bottom"}}),r.a.createElement(ye.a,null,r.a.createElement(he.a,{onClickAway:d},r.a.createElement(xe.a,{id:"split-button-menu"},we.map((function(e,t){return r.a.createElement(ve.a,{key:e,disabled:2===t,selected:t===s,onClick:function(e){return function(e,t){m(t),o(!1)}(0,t)}},e)}))))))}))))}var Se=a(347),Ce=a(142),je=a.n(Ce),Oe=a(143),Ie=a.n(Oe),ze=a(340),Te=function(e){return r.a.createElement(B.a,{style:{height:"300px"}},r.a.createElement(B.a,{style:{height:"40px"}}),r.a.createElement(ye.a,{style:{opacity:.8,paddingLeft:18,paddingRight:18}},"loading"===e.accountState?r.a.createElement(F.a,{container:!0,direction:"row",alignItems:"center",spacing:2,style:{height:64}},r.a.createElement(F.a,{item:!0,xs:12},r.a.createElement(ze.a,{color:"secondary"}))):r.a.createElement(F.a,{container:!0,direction:"row",alignItems:"center",spacing:2},r.a.createElement(F.a,{item:!0,xs:2,direction:"row"},r.a.createElement(f.a,{color:"textSecondary"},"account :")),r.a.createElement(F.a,null,r.a.createElement(f.a,{style:{fontFamily:"Courier Prime, monospace"}},e.account)),e.isvoter?r.a.createElement(F.a,{item:!0,xs:3},r.a.createElement(F.a,{container:!0,direction:"row",justify:"flex-end",spacing:2},r.a.createElement(F.a,{item:!0},r.a.createElement(f.a,{color:"textSecondary"},"Number of votes left:")),r.a.createElement(F.a,{item:!0},r.a.createElement(f.a,null,e.nbvotes)))):r.a.createElement(F.a,{item:!0,xs:3},r.a.createElement(f.a,{color:"error"},"Not registered!")))))},Pe=a(40);function We(e,t){return e.sort((function(e,a){return"sort by votes"===t?a.nbvotes-e.nbvotes:"sort by creation"===t?a.creation-e.creation:"sort by author"===t?a.author-e.author:"sort by id"!==t||e.id-a.id}))}var Ae=function(e){return new Uint8Array(e.match(/.{1,2}/g).map((function(e){return parseInt(e,16)})))};function Ne(){var e=C(),t=j(),a=S(),n=r.a.useState(null),o=Object(u.a)(n,2),c=(o[0],o[1],r.a.useState({status:!1,ideas:[],votes:[]})),l=Object(u.a)(c,2),d=l[0],p=l[1],f=r.a.useCallback(Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t("delphinet");case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),alert(e.t0.message);case 8:case 9:case"end":return e.stop()}}),e,null,[[0,5]])}))),[t]),E=r.a.useState(!1),h=Object(u.a)(E,2),g=h[0],y=h[1],b=r.a.useState(!1),v=Object(u.a)(b,2),x=v[0],w=v[1],k=r.a.useState(""),I=Object(u.a)(k,2),z=(I[0],I[1]);function T(){return U.apply(this,arguments)}function U(){return(U=Object(s.a)(i.a.mark((function e(){var t,a,n,r,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=new Pe.a("https://delphinet-tezos.giganode.io"),e.next=4,t.contract.at(m);case 4:return a=e.sent,e.next=7,a.storage();case 7:n=e.sent,r=[],n.selected.forEach((function(e){return r.push(parseInt(0+e))})),o=[],n.idea.forEach((function(e,t,a){o.push({id:t,title:Object(ie.decompressFromUint8Array)(Ae(e.title)),desc:Object(ie.decompressFromUint8Array)(Ae(e.desc)),author:e.author,nbvotes:parseInt(0+e.nbvotes,10),creation:(e.creation+"").substring(0,10),winner:r.includes(parseInt(t))})})),c=[],n.voter.forEach((function(e,t,a){c[t]=parseInt(0+e,10)})),o=We(o,"sort by creation"),console.log(o),p({status:0+n._state==="00",ideas:o,votes:c}),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log("Error: ".concat(e.t0));case 22:case"end":return e.stop()}}),e,null,[[0,19]])})))).apply(this,arguments)}function L(){return void 0!==d.votes&&a in d.votes}0===d.ideas.length&&T().then(console.log("content loaded"));var M=r.a.useMemo((function(){return Object(W.a)({palette:{type:"light",secondary:{light:"#64b5f6",main:"#2196f3",dark:"#1976d2",contrastText:"#fff"}}})}),[!1]),_=function(){y(!1),T().then(console.log("content loaded"))},G=function(){y(!0)};return r.a.createElement("div",{className:"App"},r.a.createElement(A.a,{theme:M},r.a.createElement(N.a,null),r.a.createElement(P,{theme:M,appTitle:"Vote for the best ideas!",handleConnect:f}),r.a.createElement(B.a,{maxWidth:"md",style:{height:120}},e?r.a.createElement(Te,{account:a,isvoter:L(),nbvotes:d.votes[a]}):r.a.createElement("div",{style:{height:500}})),r.a.createElement(B.a,{maxWidth:"md"},r.a.createElement(F.a,{container:!0,direction:"row",spacing:2,style:{marginBottom:100}},r.a.createElement(F.a,{item:!0,xs:12},r.a.createElement(O.a,{href:"https://better-call.dev/delphinet/"+m+"/operations",rel:"noopener",underline:"none"},r.a.createElement(Se.a,{label:"Box "+m+(d.status?" is active":" is closed"),color:d.status?"secondary":"default",clickable:!0,onDelete:function(){},deleteIcon:d.status?r.a.createElement(je.a,null):r.a.createElement(Ie.a,null),variant:"outlined"}))),0===d.ideas.length?r.a.createElement(F.a,{item:!0,xs:12},r.a.createElement(ze.a,{color:"secondary",style:{marginTop:60}})):r.a.createElement(F.a,{item:!0},r.a.createElement(ke,{onClick:function(e){z(e),p({status:d.status,ideas:We(d.ideas,e),votes:d.votes})}})),d.ideas.map((function(t){return r.a.createElement(F.a,{item:!0,xs:12},r.a.createElement(X,{id:t.id,title:t.title,desc:t.desc,author:t.author,creation:t.creation,nbvotes:t.nbvotes,winner:t.winner,boxopen:d.status&&e&&L(),openSnack:G,handleReceipt:_}))})))),d.status&&e&&L()&&!g?r.a.createElement(ee,{onClick:function(){w(!0)}}):r.a.createElement("div",null),r.a.createElement(R,{appName:"IdeaCorp."}),r.a.createElement(de,{open:x,onclose:function(){w(!1)},theme:M,account:a,openSnack:G,handleReceipt:_}),r.a.createElement(H,{open:g,theme:M})))}var Be=function(){return r.a.createElement(x,{appName:"IdeaCorp."},r.a.createElement(r.a.Suspense,{fallback:null},r.a.createElement(Ne,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Be,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},74:function(e,t,a){}},[[163,1,2]]]);
//# sourceMappingURL=main.dc058d12.chunk.js.map